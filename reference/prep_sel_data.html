<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>prep_sel_data — prep_sel_data • inser</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="../cosmo.css" rel="stylesheet"><link href="../thinkr.css" rel="stylesheet"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="prep_sel_data — prep_sel_data"><meta property="og:description" content="Transform and prepare the database in order to compute the indices of the create_selectivity_sheet() function.
Inputs are catch comparison data obtained from test and standard fishing gear.
Data are recorded under 4 tables:
TR table records all information relative to the fishing trial and the gear used;
HH table records all information relative to the fishing operation,
SL table records all information to the catch weight for each fraction (landings and discards, and eventually landing categories), species (mandatory) and eventually landing category or sex;
HL table records number of individuals for each length class.
Not all species are measured and/or weighted, but for a given species, the same level of information is required for each gear and fraction.
The create_selectivity_sheet() function ensures consistency between the 4 tables and allows for filtering on vessel/trial/fishing operation/species to create the summary sheet of the experiment.
The function computes raised numbers of individuals from sampled observed."><meta name="twitter:card" content="summary"><!-- mathjax
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!--  Code folding --><script src="../codefolding.js"></script><link href="../codefolding.css" rel="stylesheet"><!--
<script>
         document.write('<div class="navbar"><div class="container"><div id="code-folding-buttons" class="btn-group"><button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div></div></div>')
</script>
--><!-- google analytics
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script>
--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inser</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/create-selectivity-sheet.html">Create selectivity sheet</a>
    </li>
    <li>
      <a href="../articles/selectivity-data.html">Selectivity data</a>
    </li>
    <li>
      <a href="../articles/translate-selectivity-sheet-content.html">Translate selectivity sheet content</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
          <div id="code-folding-buttons" class="btn-group"><button class="btn btn-default btn-xs dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-_extension-text-contrast=""><span>Show/Hide all code</span><span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>
        </li>
        
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>prep_sel_data</h1>
    
    <div class="hidden name"><code>prep_sel_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform and prepare the database in order to compute the indices of the create_selectivity_sheet() function.</p>
<p>Inputs are catch comparison data obtained from test and standard fishing gear.</p>
<p>Data are recorded under 4 tables:
TR table records all information relative to the fishing trial and the gear used;
HH table records all information relative to the fishing operation,
SL table records all information to the catch weight for each fraction (landings and discards, and eventually landing categories), species (mandatory) and eventually landing category or sex;
HL table records number of individuals for each length class.</p>
<p>Not all species are measured and/or weighted, but for a given species, the same level of information is required for each gear and fraction.</p>
<p>The create_selectivity_sheet() function ensures consistency between the 4 tables and allows for filtering on vessel/trial/fishing operation/species to create the summary sheet of the experiment.</p>
<p>The function computes raised numbers of individuals from sampled observed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prep_sel_data</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"all"</span>, vessel <span class="op">=</span> <span class="st">"all"</span>, trip <span class="op">=</span> <span class="st">"all"</span>, station <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>    species_LAN <span class="op">=</span> <span class="st">"all"</span>, species_DIS <span class="op">=</span> <span class="st">"all"</span>, species_length <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>list A list of four data.frames (TR,HH,SL,HL) based on the ICES RDB data exchange format corresponding to each level of the dataset. EU/ICES have defined common format and processing tools, for fisheries statistics.
For more details on the input data format, see the related vignette :
<code><a href="../articles/selectivity-data.html">vignette("selectivity-data", package = "inser")</a></code></p></dd>


<dt>filters</dt>
<dd><p>list A list of filters to apply on the dataset. The optional filters can apply directly on the fields ‘project’, ‘vessel_identifier’, ‘selective_device’, ‘trip_code’, ‘station_number’. For the fields ‘species_LAN’, ‘species_DIS’, and ‘species_length’, the filter apply on the landings (LAN), discards (DIS) and on the measured species, respectively.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>data.frame A data.frame object corresponding to the join of the four tables.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If the field ‘elevated_number_at_length’ is not provided in HL or some values are missing, the function calculate them using ‘number_at_length’ and the ratio between the subsample_weight and the weight (table SL).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Example for protocol 'twin'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">OTT_data_folder</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"script_origin"</span>, <span class="st">"Data"</span>, <span class="st">"Example_OTT"</span>,</span></span>
<span class="r-in"><span>              package <span class="op">=</span> <span class="st">"inser"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">TR</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">OTT_data_folder</span>, <span class="st">"TR.csv"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  delim <span class="op">=</span> <span class="st">";"</span>,</span></span>
<span class="r-in"><span>  escape_double <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  locale <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html" class="external-link">locale</a></span><span class="op">(</span>encoding <span class="op">=</span> <span class="st">"WINDOWS-1252"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trim_ws <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">2</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">31</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Delimiter:</span> ";"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">chr</span> (12): sampling_type, landing_country, vessel_flag_country, project, harb...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">dbl</span> (11): trip_code, year, vessel_length, vessel_power, vessel_size, vessel_...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">lgl</span>  (8): number_of_sets, days_at_sea, departure_date_time, return_date_time...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">HH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">OTT_data_folder</span>, <span class="st">"HH.csv"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sep <span class="op">=</span> <span class="st">";"</span>,</span></span>
<span class="r-in"><span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  encoding <span class="op">=</span> <span class="st">"WINDOWS-1252"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="co">#,colClasses = colClasses)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">OTT_data_folder</span>, <span class="st">"SL.csv"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sep <span class="op">=</span> <span class="st">";"</span>,</span></span>
<span class="r-in"><span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  encoding <span class="op">=</span> <span class="st">"WINDOWS-1252"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">HL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">OTT_data_folder</span>, <span class="st">"HL.csv"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sep <span class="op">=</span> <span class="st">";"</span>,</span></span>
<span class="r-in"><span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  encoding <span class="op">=</span> <span class="st">"WINDOWS-1252"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">colClasses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">HH</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">colClasses</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">HH</span><span class="op">)</span> <span class="op">==</span> <span class="st">"statistical_rectangle"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="st">"character"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">HH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">OTT_data_folder</span>, <span class="st">"HH.csv"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sep <span class="op">=</span> <span class="st">";"</span>,</span></span>
<span class="r-in"><span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  colClasses <span class="op">=</span> <span class="va">colClasses</span>,</span></span>
<span class="r-in"><span>  encoding <span class="op">=</span> <span class="st">"WINDOWS-1252"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">TAB</span> <span class="op">&lt;-</span> <span class="fu">prep_sel_data</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">TR</span>, <span class="va">HH</span>, <span class="va">SL</span>, <span class="va">HL</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="thinkr">
  <p></p><p>Developed by Marie Morfin, Swann Floc’hlay, Antoine Languillaume.</p>,<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer></div>

  


  

  </body></html>

